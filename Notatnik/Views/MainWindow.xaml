<Window x:Class="Notatnik.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:Notatnik.ViewModels"
        Title="MyNotes"
        Height="650"
        Width="1050"
        WindowStartupLocation="CenterScreen"
        FontFamily="Segoe UI"
        FontSize="12">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <DockPanel>

        <!-- Menu -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_Plik">
                <MenuItem Header="Nowy...">
                    <MenuItem Header="Notatka tekstowa"     Icon="📝" Command="{Binding AddTextNoteCommand}" />
                    <MenuItem Header="Notatka lista zadań"  Icon="☑️" Command="{Binding AddCheckboxNoteCommand}" />
                    <MenuItem Header="Notatka formatowana"  Icon="📄" Command="{Binding AddLongNoteCommand}" />
                    <Separator/>
                    <MenuItem Header="Folder"               Icon="📁" Command="{Binding AddFolderCommand}" />
                </MenuItem>
                <Separator/>
                <MenuItem Header="Drukuj..." Icon="🖨" Command="{Binding PrintCommand}" />
                <Separator/>
                <MenuItem Header="Zamknij" Command="{Binding ExitCommand}" />
            </MenuItem>

            <MenuItem Header="|" IsEnabled="False" Focusable="False"/>

            <MenuItem Header="_Statystyki">
                <MenuItem Header="Dane"    />
                <MenuItem Header="Wykres..." />
                <MenuItem Header="Historia" />
            </MenuItem>
        </Menu>

        <!-- Pasek narzędzi -->
        <ToolBarTray DockPanel.Dock="Top">
            <ToolBar>
                <Button Content="📝" ToolTip="Nowa notatka tekstowa"   Command="{Binding AddTextNoteCommand}" />
                <Button Content="☑️" ToolTip="Nowa notatka checklist"  Command="{Binding AddCheckboxNoteCommand}" />
                <Button Content="📄" ToolTip="Nowa długa notatka"      Command="{Binding AddLongNoteCommand}" />
                <Separator/>
                <Button Content="📁" ToolTip="Nowy folder"             Command="{Binding AddFolderCommand}" />
                <Separator/>
                <Button Content="🔍" ToolTip="Wyszukiwanie"            Command="{Binding SearchCommand}" />
                <Button Content="🖨" ToolTip="Drukuj"                  Command="{Binding PrintCommand}" />
                <Separator/>
                <Button Content="⧉" ToolTip="Kopiuj notatkę"           Command="{Binding CopyNoteCommand}" />
                <Button Content="🗂" ToolTip="Zmień folder"            Command="{Binding MoveNoteCommand}" />
                <Button Content="🗑️" ToolTip="Usuń zaznaczone"         Command="{Binding DeleteMarkedItemsCommand}" />
            </ToolBar>
        </ToolBarTray>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="2"/>
                <ColumnDefinition Width="4*"/>
            </Grid.ColumnDefinitions>

            <!--  Foldery -->
            <Grid Grid.Column="0" Margin="5">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Foldery"
                           FontSize="14"
                           FontWeight="Bold"
                           Margin="0,0,0,5"/>

                <ListView x:Name="ListViewFolders"
                        Grid.Row="1"
                        ItemsSource="{Binding Folders}"
                        SelectedItem="{Binding SelectedFolder}"
                        SelectionMode="Single">
                    <ListView.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Edytuj" Icon="✏️"
                                      Command="{Binding EditFolderCommand}"/>
                            <MenuItem Header="Usuń" Icon="🗑️"
                                      Command="{Binding DeleteFolderCommand}"
                                      CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=ContextMenu}, Path=PlacementTarget.SelectedItem}"/>
                            <MenuItem Header="Usuń zaznaczone" Icon="🗑️"
                                      Command="{Binding DeleteMarkedFoldersCommand}"/>
                            <Separator/>
                            <MenuItem Header="Właściwości" Icon="ℹ️"
                                      Command="{Binding NotePropertiesCommand}" 
                                      CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=ContextMenu}, Path=PlacementTarget.SelectedItem}"/>
                        </ContextMenu>
                    </ListView.ContextMenu>
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="" Width="30">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsMarkedForDeletion, Mode=TwoWay}"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>

                            <GridViewColumn Header="Nazwa folderu"
                          DisplayMemberBinding="{Binding Name}"
                          Width="155"/>
                        </GridView>
                    </ListView.View>
                </ListView>
            </Grid>

            <Border Grid.Column="1" Background="LightGray" Width="1"/>

            <!-- Notatki -->
            <Grid Grid.Column="2" Margin="5">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Notatki"
                           FontSize="14"
                           FontWeight="Bold"
                           Margin="0,0,0,5"/>

                <ListView x:Name="ListViewNotes"
                          Grid.Row="1"
                          ItemsSource="{Binding Notes}"
                          SelectedItem="{Binding SingleSelectedNote}"
                          SelectionMode="Single"
                          MouseDoubleClick="ListViewNotes_MouseDoubleClick">

                    <ListView.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Edytuj" Icon="✏️"
                                      Command="{Binding EditNoteCommand}"
                                      CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=ContextMenu},
                                                                 Path=PlacementTarget.SelectedItem}"/>

                            <MenuItem Header="Usuń" Icon="🗑️"
                                      Command="{Binding DeleteNoteCommand}"
                                      CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=ContextMenu},
                                                                 Path=PlacementTarget.SelectedItem}"/>

                            <MenuItem Header="Usuń zaznaczone" Icon="🗑️"
                                      Command="{Binding DeleteMarkedNotesCommand}"/>

                            <MenuItem Header="Przenieś do folderu..." Icon="📂"
                                      Command="{Binding MoveNoteCommand}"
                                      CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=ContextMenu},
                                                                 Path=PlacementTarget.SelectedItem}"/>

                            <MenuItem Header="Kopiuj do folderu…" Icon="📋"
                                      Command="{Binding CopyNoteCommand}"
                                      CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=ContextMenu},
                                                                 Path=PlacementTarget.SelectedItem}"/>

                            <Separator/>

                            <MenuItem Header="Właściwości" Icon="ℹ️"
                                      Command="{Binding NotePropertiesCommand}"
                                      CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=ContextMenu},
                                                                 Path=PlacementTarget.SelectedItem}"/>
                        </ContextMenu>
                    </ListView.ContextMenu>

                    <ListView.View>
                        <GridView AllowsColumnReorder="True">

                            <GridViewColumn Header="" Width="30">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding IsMarkedForDeletion, Mode=TwoWay}"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>

                            <GridViewColumn Header="Tytuł" Width="200">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Title}" TextWrapping="NoWrap"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>

                            <GridViewColumn Header="Podgląd" Width="300">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Snippet}" TextWrapping="NoWrap"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>

                            <GridViewColumn Header="Utworzono" Width="130">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding CreatedAt, StringFormat=\{0:yyyy-MM-dd HH:mm\}}"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>

                            <GridViewColumn Header="Zmodyfikowano" Width="140">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding ModifiedAt, StringFormat=\{0:yyyy-MM-dd HH:mm\}}"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
            </Grid>
        </Grid>
    </DockPanel>
</Window>
